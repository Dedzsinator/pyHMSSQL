2025-03-16 17:44:53,143 - INFO - ==== DBMS Server Starting ====
2025-03-16 17:44:53,144 - INFO - Logging to: E:\Programming\pyHMSSQL\server\logs\dbms_server_20250316_174453.log
2025-03-16 17:44:53,148 - DEBUG - {"topologyId": {"$oid": "67d6f1f523d0506686a03a7a"}, "message": "Starting topology monitoring"}
2025-03-16 17:44:53,149 - DEBUG - {"topologyId": {"$oid": "67d6f1f523d0506686a03a7a"}, "previousDescription": "<TopologyDescription id: 67d6f1f523d0506686a03a7a, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 67d6f1f523d0506686a03a7a, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>", "message": "Topology description changed"}
2025-03-16 17:44:53,150 - DEBUG - {"topologyId": {"$oid": "67d6f1f523d0506686a03a7a"}, "serverHost": "localhost", "serverPort": 27017, "message": "Starting server monitoring"}
2025-03-16 17:44:53,151 - DEBUG - {"clientId": {"$oid": "67d6f1f523d0506686a03a7a"}, "message": "Connection pool created", "serverHost": "localhost", "serverPort": 27017}
2025-03-16 17:44:53,154 - INFO - CatalogManager initialized.
2025-03-16 17:44:53,154 - INFO - IndexManager initialized with directory: indexes
2025-03-16 17:44:53,156 - DEBUG - {"topologyId": {"$oid": "67d6f1f523d0506686a03a7b"}, "message": "Starting topology monitoring"}
2025-03-16 17:44:53,157 - DEBUG - {"topologyId": {"$oid": "67d6f1f523d0506686a03a7b"}, "previousDescription": "<TopologyDescription id: 67d6f1f523d0506686a03a7b, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 67d6f1f523d0506686a03a7b, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>", "message": "Topology description changed"}
2025-03-16 17:44:53,158 - DEBUG - {"topologyId": {"$oid": "67d6f1f523d0506686a03a7b"}, "serverHost": "localhost", "serverPort": 27017, "message": "Starting server monitoring"}
2025-03-16 17:44:53,158 - DEBUG - {"topologyId": {"$oid": "67d6f1f523d0506686a03a7a"}, "driverConnectionId": 1, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "message": "Server heartbeat started"}
2025-03-16 17:44:53,159 - DEBUG - {"clientId": {"$oid": "67d6f1f523d0506686a03a7b"}, "message": "Connection pool created", "serverHost": "localhost", "serverPort": 27017}
2025-03-16 17:44:53,160 - DEBUG - {"topologyId": {"$oid": "67d6f1f523d0506686a03a7a"}, "driverConnectionId": 1, "serverConnectionId": 36, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.0, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"67d68d46cab829f20eca4531\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-03-16T15:44:53.160Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 36, \"maxWireVersion\": 25, \"ok\": 1.0}", "message": "Server heartbeat succeeded"}
2025-03-16 17:44:53,161 - DEBUG - {"clientId": {"$oid": "67d6f1f523d0506686a03a7a"}, "message": "Connection pool ready", "serverHost": "localhost", "serverPort": 27017}
2025-03-16 17:44:53,161 - DEBUG - {"topologyId": {"$oid": "67d6f1f523d0506686a03a7a"}, "previousDescription": "<TopologyDescription id: 67d6f1f523d0506686a03a7a, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 67d6f1f523d0506686a03a7a, topology_type: Single, servers: [<ServerDescription ('localhost', 27017) server_type: Standalone, rtt: 0.0>]>", "message": "Topology description changed"}
2025-03-16 17:44:53,162 - DEBUG - {"topologyId": {"$oid": "67d6f1f523d0506686a03a7b"}, "driverConnectionId": 1, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "message": "Server heartbeat started"}
2025-03-16 17:44:53,163 - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 67d6f1f523d0506686a03a7a, topology_type: Single, servers: [<ServerDescription ('localhost', 27017) server_type: Standalone, rtt: 0.0>]>", "clientId": {"$oid": "67d6f1f523d0506686a03a7a"}}
2025-03-16 17:44:53,164 - DEBUG - {"topologyId": {"$oid": "67d6f1f523d0506686a03a7b"}, "driverConnectionId": 1, "serverConnectionId": 37, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.0, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"67d68d46cab829f20eca4531\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-03-16T15:44:53.164Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 37, \"maxWireVersion\": 25, \"ok\": 1.0}", "message": "Server heartbeat succeeded"}
2025-03-16 17:44:53,164 - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 67d6f1f523d0506686a03a7a, topology_type: Single, servers: [<ServerDescription ('localhost', 27017) server_type: Standalone, rtt: 0.0>]>", "clientId": {"$oid": "67d6f1f523d0506686a03a7a"}, "serverHost": "localhost", "serverPort": 27017}
2025-03-16 17:44:53,165 - DEBUG - {"clientId": {"$oid": "67d6f1f523d0506686a03a7b"}, "message": "Connection pool ready", "serverHost": "localhost", "serverPort": 27017}
2025-03-16 17:44:53,165 - DEBUG - {"topologyId": {"$oid": "67d6f1f523d0506686a03a7a"}, "driverConnectionId": 1, "serverConnectionId": 36, "serverHost": "localhost", "serverPort": 27017, "awaited": true, "message": "Server heartbeat started"}
2025-03-16 17:44:53,165 - DEBUG - {"clientId": {"$oid": "67d6f1f523d0506686a03a7a"}, "message": "Connection checkout started", "serverHost": "localhost", "serverPort": 27017}
2025-03-16 17:44:53,166 - DEBUG - {"topologyId": {"$oid": "67d6f1f523d0506686a03a7b"}, "previousDescription": "<TopologyDescription id: 67d6f1f523d0506686a03a7b, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 67d6f1f523d0506686a03a7b, topology_type: Single, servers: [<ServerDescription ('localhost', 27017) server_type: Standalone, rtt: 0.0>]>", "message": "Topology description changed"}
2025-03-16 17:44:53,167 - DEBUG - {"clientId": {"$oid": "67d6f1f523d0506686a03a7a"}, "message": "Connection created", "serverHost": "localhost", "serverPort": 27017, "driverConnectionId": 1}
2025-03-16 17:44:53,170 - DEBUG - {"topologyId": {"$oid": "67d6f1f523d0506686a03a7b"}, "driverConnectionId": 1, "serverConnectionId": 37, "serverHost": "localhost", "serverPort": 27017, "awaited": true, "message": "Server heartbeat started"}
2025-03-16 17:44:53,170 - DEBUG - {"clientId": {"$oid": "67d6f1f523d0506686a03a7a"}, "message": "Connection ready", "serverHost": "localhost", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0}
2025-03-16 17:44:53,171 - DEBUG - {"clientId": {"$oid": "67d6f1f523d0506686a03a7a"}, "message": "Connection checked out", "serverHost": "localhost", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0}
2025-03-16 17:44:53,172 - DEBUG - {"clientId": {"$oid": "67d6f1f523d0506686a03a7a"}, "message": "Command started", "command": "{\"find\": \"preferences\", \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"91s6P8SOQG6wcxW3LJJ0jQ==\", \"subType\": \"04\"}}}, \"$db\": \"dbms_project\"}", "commandName": "find", "databaseName": "dbms_project", "requestId": 18467, "operationId": 18467, "driverConnectionId": 1, "serverConnectionId": 39, "serverHost": "localhost", "serverPort": 27017}
2025-03-16 17:44:53,173 - DEBUG - {"clientId": {"$oid": "67d6f1f523d0506686a03a7a"}, "message": "Command succeeded", "durationMS": 2.0, "reply": "{\"cursor\": {\"ns\": \"dbms_project.preferences\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "dbms_project", "requestId": 18467, "operationId": 18467, "driverConnectionId": 1, "serverConnectionId": 39, "serverHost": "localhost", "serverPort": 27017}
2025-03-16 17:44:53,174 - DEBUG - {"clientId": {"$oid": "67d6f1f523d0506686a03a7a"}, "message": "Connection checked in", "serverHost": "localhost", "serverPort": 27017, "driverConnectionId": 1}
2025-03-16 17:44:53,174 - INFO - Testing SQL parser with example queries
2025-03-16 17:44:53,175 - DEBUG - Parsing SQL query: SELECT id, name FROM users WHERE age > 18
2025-03-16 17:44:53,182 - DEBUG - Parsed SQL result: {'type': 'SELECT', 'query': 'SELECT id, name FROM users WHERE age > 18', 'columns': ['id', 'name'], 'tables': [], 'where': None, 'joins': [], 'groupBy': [], 'having': None, 'orderBy': [], 'limit': None}
2025-03-16 17:44:53,182 - INFO - Test query: SELECT id, name FROM users WHERE age > 18
2025-03-16 17:44:53,183 - INFO - Parsed result: {"type": "SELECT", "query": "SELECT id, name FROM users WHERE age > 18", "columns": ["id", "name"], "tables": [], "where": null, "joins": [], "groupBy": [], "having": null, "orderBy": [], "limit": null}
2025-03-16 17:44:53,183 - DEBUG - Parsing SQL query: INSERT INTO users (id, name) VALUES (1, 'test')
2025-03-16 17:44:53,185 - DEBUG - Parsed SQL result: {'type': 'INSERT', 'query': "INSERT INTO users (id, name) VALUES (1, 'test')", 'table': 'users', 'columns': [], 'values': []}
2025-03-16 17:44:53,185 - INFO - Test query: INSERT INTO users (id, name) VALUES (1, 'test')
2025-03-16 17:44:53,185 - INFO - Parsed result: {"type": "INSERT", "query": "INSERT INTO users (id, name) VALUES (1, 'test')", "table": "users", "columns": [], "values": []}
2025-03-16 17:44:53,186 - DEBUG - Parsing SQL query: UPDATE users SET name = 'John' WHERE id = 1
2025-03-16 17:44:53,187 - DEBUG - Parsed SQL result: {'type': 'UPDATE', 'query': "UPDATE users SET name = 'John' WHERE id = 1", 'table': 'users', 'set': {'': ''}, 'where': None}
2025-03-16 17:44:53,188 - INFO - Test query: UPDATE users SET name = 'John' WHERE id = 1
2025-03-16 17:44:53,188 - INFO - Parsed result: {"type": "UPDATE", "query": "UPDATE users SET name = 'John' WHERE id = 1", "table": "users", "set": {"": ""}, "where": null}
2025-03-16 17:44:53,189 - DEBUG - Parsing SQL query: DELETE FROM users WHERE id = 1
2025-03-16 17:44:53,190 - DEBUG - Parsed SQL result: {'type': 'DELETE', 'query': 'DELETE FROM users WHERE id = 1', 'table': 'users', 'where': None}
2025-03-16 17:44:53,190 - INFO - Test query: DELETE FROM users WHERE id = 1
2025-03-16 17:44:53,191 - INFO - Parsed result: {"type": "DELETE", "query": "DELETE FROM users WHERE id = 1", "table": "users", "where": null}
2025-03-16 17:44:53,191 - DEBUG - Parsing SQL query: CREATE TABLE users (id INT PRIMARY KEY, name TEXT)
2025-03-16 17:44:53,193 - DEBUG - Parsed SQL result: {'type': 'CREATE', 'query': 'CREATE TABLE users (id INT PRIMARY KEY, name TEXT)', 'table': 'users', 'database': None, 'index': None, 'column': None, 'unique': False, 'columns': [], 'constraints': []}
2025-03-16 17:44:53,193 - INFO - Test query: CREATE TABLE users (id INT PRIMARY KEY, name TEXT)
2025-03-16 17:44:53,194 - INFO - Parsed result: {"type": "CREATE", "query": "CREATE TABLE users (id INT PRIMARY KEY, name TEXT)", "table": "users", "database": null, "index": null, "column": null, "unique": false, "columns": [], "constraints": []}
2025-03-16 17:44:53,195 - INFO - Server listening on localhost:9999
2025-03-16 17:45:03,168 - DEBUG - {"topologyId": {"$oid": "67d6f1f523d0506686a03a7a"}, "driverConnectionId": 1, "serverConnectionId": 36, "serverHost": "localhost", "serverPort": 27017, "awaited": true, "durationMS": 10000.0, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"67d68d46cab829f20eca4531\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-03-16T15:45:03.168Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 36, \"maxWireVersion\": 25, \"ok\": 1.0}", "message": "Server heartbeat succeeded"}
2025-03-16 17:45:03,170 - DEBUG - {"topologyId": {"$oid": "67d6f1f523d0506686a03a7a"}, "driverConnectionId": 1, "serverConnectionId": 36, "serverHost": "localhost", "serverPort": 27017, "awaited": true, "message": "Server heartbeat started"}
2025-03-16 17:45:03,172 - DEBUG - {"topologyId": {"$oid": "67d6f1f523d0506686a03a7b"}, "driverConnectionId": 1, "serverConnectionId": 37, "serverHost": "localhost", "serverPort": 27017, "awaited": true, "durationMS": 10000.0, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"67d68d46cab829f20eca4531\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-03-16T15:45:03.172Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 37, \"maxWireVersion\": 25, \"ok\": 1.0}", "message": "Server heartbeat succeeded"}
2025-03-16 17:45:03,174 - DEBUG - {"topologyId": {"$oid": "67d6f1f523d0506686a03a7b"}, "driverConnectionId": 1, "serverConnectionId": 37, "serverHost": "localhost", "serverPort": 27017, "awaited": true, "message": "Server heartbeat started"}
2025-03-16 17:45:13,169 - DEBUG - {"topologyId": {"$oid": "67d6f1f523d0506686a03a7a"}, "driverConnectionId": 1, "serverConnectionId": 36, "serverHost": "localhost", "serverPort": 27017, "awaited": true, "durationMS": 10000.0, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"67d68d46cab829f20eca4531\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-03-16T15:45:13.169Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 36, \"maxWireVersion\": 25, \"ok\": 1.0}", "message": "Server heartbeat succeeded"}
2025-03-16 17:45:13,172 - DEBUG - {"topologyId": {"$oid": "67d6f1f523d0506686a03a7a"}, "driverConnectionId": 1, "serverConnectionId": 36, "serverHost": "localhost", "serverPort": 27017, "awaited": true, "message": "Server heartbeat started"}
2025-03-16 17:45:13,173 - DEBUG - {"topologyId": {"$oid": "67d6f1f523d0506686a03a7b"}, "driverConnectionId": 1, "serverConnectionId": 37, "serverHost": "localhost", "serverPort": 27017, "awaited": true, "durationMS": 10000.0, "reply": "{\"isWritablePrimary\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"67d68d46cab829f20eca4531\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-03-16T15:45:13.172Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 37, \"maxWireVersion\": 25, \"ok\": 1.0}", "message": "Server heartbeat succeeded"}
2025-03-16 17:45:13,177 - DEBUG - {"topologyId": {"$oid": "67d6f1f523d0506686a03a7b"}, "driverConnectionId": 1, "serverConnectionId": 37, "serverHost": "localhost", "serverPort": 27017, "awaited": true, "message": "Server heartbeat started"}
